<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to GenErlang Fit ‚Ä¢ GenErlangFit</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="‚Äùimage/svg+xml‚Äù" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to GenErlang Fit">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GenErlangFit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/GettingStarted.html">Getting Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/FAQ.html">FAQ</a></li>
    <li><a class="dropdown-item" href="../articles/GettingStarted.html">Introduction to GenErlang Fit</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Introduction to GenErlang Fit</h1>
                        <h4 data-toc-skip class="author">Vivek
Murali</h4>
            
      

      <div class="d-none name"><code>GettingStarted.Rmd</code></div>
    </div>

    
    
<style type="text/css">
body {
  text-align: justify;
}


</style>
<div class="section level2">
<h2 id="context-and-package-overview">Context and Package Overview<a class="anchor" aria-label="anchor" href="#context-and-package-overview"></a>
</h2>
<p>The GenErlangFit package aims to identify the optimal generalized
Erlang or Erlang‚ÄìExponential model consistent with observed
time-to-event data.</p>
<p>Standard compartmental models of infectious diseases often assume
constant transition rates between states, which implies an exponential
distribution of ‚Äúwaiting times‚Äù in each state. (e.g., the latent period,
the infectious period). However, this assumption does not align with
empirical data for many diseases. The Linear Chain Trick (LCT) offers a
computationally tractable alternative by modeling each state as a series
of multiple identical substates, producing Erlang-distributed waiting
times (Gamma distribution with an integer shape parameter).</p>
<p>Our approach combines maximum likelihood parameter estimation with
non-parametric significance testing to prioritize the simplest model
structures that produce waiting times consistent with observed data. To
improve flexibility, we incorporate the Erlang-Exponential model‚Äîan
extension of the standard Erlang distribution that adds a final
exponential stage‚Äî allowing better approximation of empirical
distributions with varying skewness and tail behavior.</p>
<p>This user-friendly package enables modelers to fit empirical data and
build parsimonious, data-driven compartmental models across diverse
domains. A thorough walk through of the fitting algorithms and
assumptions can be found in the <a href="FAQ.html"><strong>FAQ vignette
linked here</strong></a>. This vignette serves as simple tutorial on how
users can get started with this package.</p>
<hr>
</div>
<div class="section level2">
<h2 id="package-installation-from-github">Package Installation from Github<a class="anchor" aria-label="anchor" href="#package-installation-from-github"></a>
</h2>
<p>To install and load the package from GitHub, run these commands in
the R console and load the following libraries:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"vivekmurals/GenErlangFit"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">GenErlangFit</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="using-the-package">Using the Package<a class="anchor" aria-label="anchor" href="#using-the-package"></a>
</h2>
<div class="section level3">
<h3 id="data-format">Data Format<a class="anchor" aria-label="anchor" href="#data-format"></a>
</h3>
<p>Before fitting, the input <code>empiricaldata</code> must be provided
as a single numeric vector of observed time-to-event values, with all
entries strictly positive. If your data are stored in a CSV file with a
column named Time, you can load them using:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">empiricaldata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">3.4</span>, <span class="fl">2.1</span>, <span class="fl">5.6</span>, <span class="fl">4.3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># or loaded from a file:</span></span>
<span><span class="va">empiricaldata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"mydata.csv"</span><span class="op">)</span><span class="op">$</span><span class="va">Time</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="general-fitting-under-default-settings">General Fitting under Default Settings<a class="anchor" aria-label="anchor" href="#general-fitting-under-default-settings"></a>
</h3>
<p>In general, the user only needs to be familiar using one single
function <code>GenErlang_Fit</code>. By default, if the user runs the
following line of code with <code>empiricaldata</code> as the only
argument,</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GenErlang_Fit.html">GenErlang_Fit</a></span><span class="op">(</span><span class="va">empiricaldata</span><span class="op">)</span></span></code></pre></div>
<p>the function will run both the Erlang and Erlang-Exp fit, run
goodness of fit evaluations for both and in addition, search for the
smallest statistically acceptable K for both models. More on what the
smallest K model means can be found in <a href="FAQ.html#smallest-k"><strong>FAQ: Smallest K
Model</strong></a>.</p>
<p>Users also have the ability to choose the specific model they would
like to fit the data to via specifying the following input
arguments:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GenErlang_Fit.html">GenErlang_Fit</a></span><span class="op">(</span><span class="st">'Erlang'</span>, <span class="va">empiricaldata</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/GenErlang_Fit.html">GenErlang_Fit</a></span><span class="op">(</span><span class="st">'ErlangExp'</span>, <span class="va">empiricaldata</span>, <span class="va">K</span><span class="op">)</span></span></code></pre></div>
<p><strong>Quick Note:</strong> When running specific models, the model
name must always be provided as the first argument. For the
Erlang-Exponential model, an additional input argument K must always be
provided since the search for the optimal K is handled differently from
that of the Erlang. See <a href="FAQ.html#erlangexp-k"><strong>FAQ:
Erlang-Exp Fit</strong></a>.</p>
<p>While these default modes are designed to be comprehensive and is
generally the best starting point for first-time users, those who prefer
a quicker initial exploration may first run the Erlang model alone to
get a broad sense of the empirical data‚Äôs structure.</p>
<div class="section level4">
<h4 id="outputs-from-generlang_fit">Outputs from GenErlang_Fit<a class="anchor" aria-label="anchor" href="#outputs-from-generlang_fit"></a>
</h4>
<p>The object returned by GenErlang_Fit is a structured list that
organizes all results produced during the fitting procedure. For
example, after running:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GenErlang_Fit.html">GenErlang_Fit</a></span><span class="op">(</span><span class="st">'Erlang'</span>, <span class="va">empiricaldata</span><span class="op">)</span></span></code></pre></div>
<p>the main components of the output‚Äî <code>Results$BestFit</code> and
<code>Results$SmallestK</code> ‚Äî contain the corresponding fitted model
summaries. Each of these components includes the estimated model
parameters, the log-likelihood, the goodness-of-fit quantities, and
summary statistics used in the evaluation.</p>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="model-specific-fitting-options">Model Specific Fitting Options<a class="anchor" aria-label="anchor" href="#model-specific-fitting-options"></a>
</h3>
<p>Once users are familiar with the default behavior of
<code>GenErlang_Fit</code>, users can proceed onto learning how to
customize different aspects the fitting workflow. The following sections
outline the main categories of options available when departing from the
default settings: Fit Options (e.g., changing initial guesses or
controlling the Erlang-exp search over K), Goodness-of-Fit Options
(e.g., bootstrap-based confidence intervals and p-value estimation), and
the Smallest-K Search tools used for model parsimony or computational
efficiency. Each subsection explains the purpose of these options, how
to call them, and in what situations users may want to override the
defaults.</p>
<div class="section level4">
<h4 id="overriding-initial-guesses">Overriding initial guesses<a class="anchor" aria-label="anchor" href="#overriding-initial-guesses"></a>
</h4>
<p>GenErlang_Fit provides default initialization values for all
optimization routines. Users may optionally supply their own initial
guesses to customize the fitting process or to assess the robustness of
results to different starting values.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GenErlang_Fit.html">GenErlang_Fit</a></span><span class="op">(</span><span class="st">'Erlang'</span>, <span class="va">empiricaldata</span>, <span class="st">'InitialguessK = VALUE'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/GenErlang_Fit.html">GenErlang_Fit</a></span><span class="op">(</span><span class="st">'ErlangExp'</span>, <span class="va">empiricaldata</span>, <span class="va">K</span>, <span class="st">'InitialguessErlam = VALUE'</span><span class="op">)</span></span></code></pre></div>
<ul>
<li><p>Erlang model: the initial guess refers to the Erlang shape
parameter, K used during optimization.</p></li>
<li><p>Erlang‚ÄìExponential model: the initial guess refers to the Erlang
rate parameter ùúÜ because K is provided explicitly by the user.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="additional-erlang-exp-fitting-option">Additional Erlang-Exp Fitting Option<a class="anchor" aria-label="anchor" href="#additional-erlang-exp-fitting-option"></a>
</h4>
<p>For the Erlang‚ÄìExponential model, the input parameter K plays a dual
role depending on user settings: it can either be treated as a fixed
shape parameter for which the maximum likelihood estimate is computed
directly, or it can serve as the central value around which the function
searches a range of nearby K values to identify a better-fitting model
structure.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GenErlang_Fit.html">GenErlang_Fit</a></span><span class="op">(</span><span class="st">'ErlangExp'</span>, <span class="va">empiricaldata</span>, <span class="va">K</span>, FixedK <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/GenErlang_Fit.html">GenErlang_Fit</a></span><span class="op">(</span><span class="st">'ErlangExp'</span>, <span class="va">empiricaldata</span>, <span class="va">K</span>, FixedK <span class="op">=</span> <span class="cn">FALSE</span>, KwindowSize <span class="op">=</span> <span class="va">VALUE</span><span class="op">)</span></span></code></pre></div>
<p>When FixedK = TRUE, the function performs a pure MLE fit for the
given K, using any supplied initial conditions. When FixedK = FALSE, the
function expands the search to include K ¬± a user-defined window
(KwindowSize), rendering initial guess overrides less relevant because
the optimization is repeated across multiple candidate structures.THis
is the default option when FixedK argument is not provided.</p>
</div>
</div>
<div class="section level3">
<h3 id="goodness-of-fit-options">Goodness of Fit Options<a class="anchor" aria-label="anchor" href="#goodness-of-fit-options"></a>
</h3>
<p>GenErlang_Fit provides built-in tools for assessing how well each
fitted model matches the empirical distribution. These options apply to
both Erlang and Erlang‚ÄìExp models and include:</p>
<ul>
<li>Choice of test statistic (via <code>pvaloption</code>)</li>
<li>Significance level (<code>Alpha</code>)</li>
<li>Number of bootstrap samples (<code>NumBootStraps</code>)</li>
</ul>
<p>A detailed description on how the goodness of fit of a model is
evaluated can be found here: <a href="FAQ.html#gof"><strong>FAQ:
Goodness of Fit Evaluation</strong></a>.</p>
<div class="section level4">
<h4 id="overriding-choice-of-test-statistic">Overriding choice of Test Statistic<a class="anchor" aria-label="anchor" href="#overriding-choice-of-test-statistic"></a>
</h4>
<p>Users can select which distance measure to use in evaluating the
model‚Äôs goodness-of-fit. Available options are:</p>
<ul>
<li>‚ÄúKS‚Äù ‚Äî Kolmogorov‚ÄìSmirnov Statistic</li>
<li>‚ÄúCVM‚Äù ‚Äî Cram√©r‚Äìvon Mises Statistic</li>
<li>‚ÄúAD‚Äù ‚Äî Anderson‚ÄìDarling Statistic</li>
<li>‚ÄúNIL‚Äù ‚Äî skips evaluation entirely and just performs the model
fit</li>
</ul>
<p>Users can specify the test statistic by providing the
<code>pvaloption</code> argument as follows:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GenErlang_Fit.html">GenErlang_Fit</a></span><span class="op">(</span><span class="st">'Erlang'</span>, <span class="va">empiricaldata</span>, pvaloption <span class="op">=</span> <span class="st">'KS'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/GenErlang_Fit.html">GenErlang_Fit</a></span><span class="op">(</span><span class="st">'ErlangExp'</span>, <span class="va">empiricaldata</span>, <span class="va">K</span>, pvaloption <span class="op">=</span> <span class="st">'NIL'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="overriding-choice-of-alpha">Overriding choice of Alpha<a class="anchor" aria-label="anchor" href="#overriding-choice-of-alpha"></a>
</h4>
<p>The argument <code>Alpha</code> determines the significance level
(rejection threshold) used when evaluating the bootstrap test
statistics. Smaller values correspond to a more conservative
goodness-of-fit assessment.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GenErlang_Fit.html">GenErlang_Fit</a></span><span class="op">(</span><span class="st">'Erlang'</span>, <span class="va">empiricaldata</span>, Alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/GenErlang_Fit.html">GenErlang_Fit</a></span><span class="op">(</span><span class="st">'ErlangExp'</span>, <span class="va">empiricaldata</span>, <span class="va">K</span>, Alpha <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="overriding-choice-of-number-of-bootstraps">Overriding choice of Number of Bootstraps<a class="anchor" aria-label="anchor" href="#overriding-choice-of-number-of-bootstraps"></a>
</h4>
<p>Increasing the number of bootstrap samples improves the stability and
precision of p-value estimates‚Äîbut also increases runtime. Users can
control this by setting the <code>NumBootStraps</code> argument to any
value of interest as follows:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GenErlang_Fit.html">GenErlang_Fit</a></span><span class="op">(</span><span class="st">'Erlang'</span>, <span class="va">empiricaldata</span>, NumBootStraps <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/GenErlang_Fit.html">GenErlang_Fit</a></span><span class="op">(</span><span class="st">'ErlangExp'</span>, <span class="va">empiricaldata</span>, <span class="va">K</span>, NumBootStraps <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="smallest-k-option">Smallest K Option<a class="anchor" aria-label="anchor" href="#smallest-k-option"></a>
</h3>
<p>The ‚ÄúSmallest-K‚Äù routines automatically search for the simplest model
that remains statistically consistent with the observed data. Starting
from the best-fitting K, the procedure iteratively tests decreasing
values of K to identify the smallest value of K that still meets the
user‚Äôs goodness-of-fit criteria (i.e., p &gt; Œ±). A detailed description
of this section can be found here: <a href="FAQ.html#smallest-k"><strong>FAQ: Smallest K
Model</strong></a>.</p>
<p>Users can enable the smallest-K search by specifying the
<code>SmallestK</code> argument as follows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GenErlang_Fit.html">GenErlang_Fit</a></span><span class="op">(</span><span class="st">'Erlang'</span>, <span class="va">empiricaldata</span>, SmallestK <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/GenErlang_Fit.html">GenErlang_Fit</a></span><span class="op">(</span><span class="st">'ErlangExp'</span>, <span class="va">empiricaldata</span>, <span class="va">K</span>, SmallestK <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/GenErlang_Fit.html">GenErlang_Fit</a></span><span class="op">(</span><span class="st">'ErlangExp'</span>, <span class="va">empiricaldata</span>, <span class="va">K</span>, SmallestK <span class="op">=</span> <span class="cn">TRUE</span>, SmallestKvalue <span class="op">=</span> <span class="va">VALUE</span><span class="op">)</span></span></code></pre></div>
<p>For Erlang‚ÄìExponential models specifically, the optional
<code>SmallestKvalue</code> sets the starting value of K for the
iterative search. This can help reduce computational time if users
suspect that the smallest acceptable K is much lower than the
best-fitting K.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The GenErlangFit package offers a flexible and user-friendly toolkit
for fitting generalized Erlang and Erlang‚ÄìExponential models to
empirical time-to-event data. By identifying the appropriate number of
substates (shape parameters) and transition rates, the package helps
users build parsimonious compartmental models that more accurately
capture the underlying biological or process dynamics.</p>
<p>We encourage users to explore the different fitting options,
goodness-of-fit evaluations, and the smallest-K search to tailor the
analysis to their specific datasets and research questions. For a deeper
dive into the theoretical foundations, algorithmic details, and
troubleshooting tips, please consult the <a href="FAQ.html"><strong>FAQ
vignette linked here</strong></a>.</p>
<p>If you encounter any issues or have suggestions for new features,
feel free to open an issue on the <a href="https://github.com/vivekmurals/GenErlangFit/issues" class="external-link"><strong>GitHub
repository</strong></a>.</p>
<p>Thank you for using GenErlangFit and We look forward to seeing how
GenErlangFit aids your modeling efforts!</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vivek Murali, Alison Hill, Anjalika Nande.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
