<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>FAQ • GenErlangFit</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="FAQ">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GenErlangFit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/GettingStarted.html">Getting Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/FAQ.html">FAQ</a></li>
    <li><a class="dropdown-item" href="../articles/GettingStarted.html">Introduction to GenErlang Fit</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>FAQ</h1>
                        <h4 data-toc-skip class="author">Vivek
Murali</h4>
            
      

      <div class="d-none name"><code>FAQ.Rmd</code></div>
    </div>

    
    
<style type="text/css">
body {
  text-align: justify;
}

</style>
<div class="section level2">
<h2 id="fitting-algorithms-and-assumptions">Fitting Algorithms and Assumptions<a class="anchor" aria-label="anchor" href="#fitting-algorithms-and-assumptions"></a>
</h2>
<p>This package computes the maximum likelihood estimates (MLE) of an
Erlang distribution (K, λ) and/or MLE of an Erlang-Exponential
distribution (K, λ<sub>Erlang</sub>, λ<sub>Exponential</sub>) from
observed data.<br>
## Erlang Fit Algorithm</p>
<p>The algorithm calculates the maximum likelihood estimates (MLE) of an
Erlang distribution from observed data. Since the Erlang shape parameter
K must be an integer, direct optimization over K using common
optimization libraries is non-trivial. To address this, we first
minimize the negative log-likelihood of the observed data under a Gamma
distribution with respect to its continuous shape parameter K, using
numerical optimization. This provides a candidate value of K which can
be adjusted to nearest integers to identify the maximum likelihood
estimates for the Erlang distribution. The exact details of this are
explained below.</p>
<p>This search starts from an initial guess for K specified by
<code>InitialguessK</code>. The cost function to be minimized with
respect to K is the negative log likelihood of the observed data given a
Gamma distribution:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mfrac><mrow><msup><mi>λ</mi><mi>K</mi></msup><msubsup><mi>x</mi><mi>i</mi><mrow><mi>K</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msup><mi>e</mi><mrow><mi>−</mi><mi>λ</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></msup></mrow><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>!</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
- \log \left( \prod_{i=1}^N \frac{\lambda^K x_i^{K - 1} e^{-\lambda x_i}}{(K - 1)!} \right)
</annotation></semantics></math></p>
<p>In the function above,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math>
refers to the observed data, N refers to the size of the observed data
while K and λ are the shape and scale parameters of the Gamma
distribution. The corresponding scale parameter, λ used in the
evaluation of the negative log likelihood is calculated from the initial
guess K via the following relationship, where μ is the mean of the
observed data:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>K</mi><mi>λ</mi></mfrac><mo>=</mo><mi>μ</mi></mrow><annotation encoding="application/x-tex">
\frac{K}{\lambda} = \mu
</annotation></semantics></math></p>
<p>This relationship exists at the MLE of a Gamma distribution (and by
extension an Erlang). Specifically, this relationship arises from the
Gamma MLE conditions: differentiating the log-likelihood with respect to
λ and setting that to 0 yields λ = K / μ. We leverage this relationship
having to only search over one variable K.</p>
<p>After finding the optimal continuous K, the floor ⌊K⌋ and ceiling ⌈K⌉
of this value are evaluated as candidate integer K values for finding
the MLE of the Erlang Distribution. For each candidate K, the respective
λ is computed from λ = K / μ which holds at the MLE, and the
log-likelihood of the observed data given an Erlang distribution is
computed. The pair of integer K* and λ* that gives the higher
log-likelihood is selected as the MLE for the Erlang Distribution.</p>
<p>In the special case where ⌈K⌉ = 0, the candidate K = 0 is not
admissible in an Erlang Distribution. Therefore, K = 1 and λ = 1 / μ
will be the MLE for the distribution. This also corresponds to an
exponential distribution with mean and variance λ.</p>
<p>Assumptions: The likelihood of the observed data given a Gamma
distribution forms a 2D surface over continuous variables K and λ. At
the MLE, these parameters satisfy K / λ = μ, reducing our search space
to a 1D line through this surface. Once the optimal continuous (K, λ)
for the Gamma is found, the floor and ceiling of K are selected as the
two corresponding Erlang candidates.</p>
<p>This method assumes: (1) the maximum likelihood found for the
continuous Gamma distribution along this line is the true global
maximum, and (2) the likelihood function along the segment between floor
⌊K⌋ and ceiling ⌈K⌉ is monotonic and continuous, allowing us to identify
the MLE of an Erlang distribution by checking only these two integer
neighbors.</p>
<div class="section level3">
<h3 id="erlangexp-k">Erlang-Exp Fit Algorithm<a class="anchor" aria-label="anchor" href="#erlangexp-k"></a>
</h3>
<div class="section level4">
<h4 id="what-is-an-erlang-exponential-distribution">What is an Erlang-Exponential Distribution?<a class="anchor" aria-label="anchor" href="#what-is-an-erlang-exponential-distribution"></a>
</h4>
<p>The Erlang–Exponential distribution describes the sum of 2
independent random variables: an erlang random variable with shape
parameter K and rate parameter,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mtext mathvariant="normal">Erlang</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{Erlang}}</annotation></semantics></math>
and an exponential random variable with rate parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mtext mathvariant="normal">Exponential</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{Exponential}}</annotation></semantics></math>.
Essentially, this distribution generalizes the Erlang distribution by
adding an extra exponential stage, which can be either faster or slower
than the Erlang stages. This allows for better approximation of
empirical distributions with varying skewness and tail behavior.</p>
</div>
<div class="section level4">
<h4 id="fit-algorithm">Fit Algorithm<a class="anchor" aria-label="anchor" href="#fit-algorithm"></a>
</h4>
<p>By default, this algorithm performs an adaptive search across a range
of K-values centered around the input value of K to best identify K –
along with the corresponding
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mtext mathvariant="normal">Erlang</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{Erlang}}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mtext mathvariant="normal">Exponential</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{Exponential}}</annotation></semantics></math>
– that maximizes the likelihood of the observed data. If ‘FixedK’, true
is specified, the algorithm instead computes the MLEs
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mtext mathvariant="normal">Erlang</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{Erlang}}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mtext mathvariant="normal">Exponential</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{Exponential}}</annotation></semantics></math>)
for a fixed value of K (specified input value of K).</p>
<p>This section details how the algorithm computes the MLE for a fixed
input argument K. This is the backbone of the overall procedure, since
the adaptive search described earlier simply repeats this fixed-K
estimation across multiple candidate K values.</p>
<p>The algorithm calculates the MLE
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mtext mathvariant="normal">Erlang</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{Erlang}}</annotation></semantics></math>
&amp;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mtext mathvariant="normal">Exponential</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{Exponential}}</annotation></semantics></math>)
of an Erlang-Exponential distribution from observed data for a given
input shape parameter K through optimizing a cost function that
minimizes the negative log likelihood of the observed data given an
Erlang-Exponential distribution. This optimization starts from an
initial guess for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mtext mathvariant="normal">Erlang</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{Erlang}}</annotation></semantics></math>
specified by <code>InitialguessErLam</code>.</p>
<p>The negative log likelihood itself is computed using a custom
function which outputs both the pointwise PDF of the Erlang–Exponential
distribution and the log-likelihood of the observed dataset under the
model.</p>
<p>Note: This custom function performs direct numerical integration of
the convolution of an Erlang distribution with an Exponential
distribution. The expression for this convolution is as follows:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msubsup><mi>λ</mi><mrow><mi>E</mi><mi>r</mi></mrow><mi>k</mi></msubsup><msub><mi>λ</mi><mrow><mi>E</mi><mi>x</mi><mi>p</mi></mrow></msub></mrow><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>!</mi></mrow></mfrac><msup><mi>e</mi><mrow><mi>−</mi><msub><mi>λ</mi><mrow><mi>E</mi><mi>x</mi><mi>p</mi></mrow></msub><mi>z</mi></mrow></msup><msubsup><mo>∫</mo><mn>0</mn><mi>z</mi></msubsup><msup><mi>x</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>e</mi><mrow><mi>−</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mrow><mi>E</mi><mi>r</mi></mrow></msub><mo>−</mo><msub><mi>λ</mi><mrow><mi>E</mi><mi>x</mi><mi>p</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>x</mi></mrow></msup><mspace width="0.167em"></mspace><mi>d</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">
\frac{\lambda_{Er}^k \lambda_{Exp}}{(k - 1)!} e^{-\lambda_{Exp} z} \int_0^z x^{k - 1} e^{-(\lambda_{Er} - \lambda_{Exp}) x} \, dx
</annotation></semantics></math></p>
<p>In computing the negative log likelihood, the corresponding
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mtext mathvariant="normal">Exponential</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{Exponential}}</annotation></semantics></math>
is calculated via the following relationship, which exists at the MLE of
this function:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>K</mi><msub><mi>λ</mi><mrow><mi>E</mi><mi>r</mi><mi>l</mi><mi>a</mi><mi>n</mi><mi>g</mi></mrow></msub></mfrac><mo>+</mo><mfrac><mn>1</mn><msub><mi>λ</mi><mrow><mi>E</mi><mi>x</mi><mi>p</mi><mi>o</mi><mi>n</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>a</mi><mi>l</mi></mrow></msub></mfrac><mo>=</mo><mi>μ</mi></mrow><annotation encoding="application/x-tex">
\frac{K}{\lambda_{Erlang}} + \frac{1}{\lambda_{Exponential}} = \mu
</annotation></semantics></math></p>
<p>The pair of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mtext mathvariant="normal">Erlang</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{Erlang}}</annotation></semantics></math>
&amp;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mtext mathvariant="normal">Exponential</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{Exponential}}</annotation></semantics></math>
that maximizes the log-likelihood is selected as the MLE for the
Erlang-Exponential Distribution from the observed data.</p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="gof">Goodness of Fit Evaluation<a class="anchor" aria-label="anchor" href="#gof"></a>
</h2>
<div class="section level3">
<h3 id="bootstrap-hypothesis-testing">Bootstrap Hypothesis Testing<a class="anchor" aria-label="anchor" href="#bootstrap-hypothesis-testing"></a>
</h3>
<p>Assessment of the goodness-of-fit of the estimated Erlang or
Erlang-Exp model is evaluated through parametric bootstrap hypothesis
testing.</p>
<p>The hypotheses are:</p>
<ul>
<li>
<strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>:</strong>
The observed data could have come from the fitted distribution.</li>
<li>
<strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_1</annotation></semantics></math>:</strong>
The observed data is not consistent with having come from the fitted
distribution.</li>
</ul>
<p>In assessing this, a test statistic, (T*) is first computed between
the observed data and the best-fit model under the null hypothesis.
Next, n (default n = 10,000) synthetic datasets are generated from the
best-fit model, each being the same size as the empirical dataset. The
same statistics are then computed for each synthetic dataset against the
best-fit model (without refitting) which yields an empirical null
distribution of the statistic under the fitted model. The observed
statistic (T*) is then compared to this null distribution to obtain a
bootstrap p-value (p*), defined as the proportion of bootstrap
statistics at least as extreme as the observed one. This p* is further
mapped to a binary decision variable q* where q* = 0 indicates rejection
of the null hypothesis at a significance level α (specified by ‘Alpha’),
and q* = 1 indicates otherwise.</p>
<p>The specific choice of the test statistic is determined by the
user-specified <code>pvaloption</code> (where <code>pvaloption</code> =
<code>KS</code>, <code>AD</code>, <code>CvM</code> correspond to
distance based test statistics such as the Kolmogorov–Smirnov (KS),
Anderson–Darling (AD), and the Cramér–von Mises (CvM) statistic,
respectively).</p>
<p>As an example to illustrate this, when the default
<code>pvaloption</code> = <code>KS</code> is specified, the
Kolmogorov–Smirnov (KS) test statistic is used, which calculates the
maximum distance between empirical data CDF and the best-fit model CDF.
This statistic (T*) is first computed for the observed data CDF against
the best-fit model CDF. This same statistic is then computed for each of
the n synthetic datasets against best-fit model CDF, producing an
empirical null distribution under the assumption that the null
hypothesis is true. The p-value (p*) is calculated as the proportion of
bootstrap statistics greater than or equal to the observed statistic
(T*), i.e., quantifies the probability of observing a statistic at least
as extreme as the empirical one under the null (H0). At a chosen
significance level α, the null is rejected if p* &lt; α and retained
otherwise. In implementation, this decision is encoded using a binary
indicator q where q = 0 denotes rejection of the null (model fails)
while q = 1 denotes non-rejection of the null (model passes)</p>
<div class="section level4">
<h4 id="additional-note-for-the-erlang-exponential-fit">Additional note for the Erlang-Exponential Fit<a class="anchor" aria-label="anchor" href="#additional-note-for-the-erlang-exponential-fit"></a>
</h4>
<p>Since there is no closed-form CDF for the Erlang–Exponential
distribution, the cumulative distribution is obtained through numerical
integration of the convolution expression.</p>
<p>This function first approximates the Erlang–Exponential PDF on a
uniform grid of points 0:interval:max(observed data) (with default
interval = 0.01). These approximate PDF values are then cumulatively
integrated across the grid to obtain the CDF. Interpolation is used to
estimate CDF values at the observed data points. This approximate CDF is
subsequently used to evaluate the distance-based test statistics, (i.e.,
maximum distance between empirical data CDF and the fitted model
CDF).</p>
<p>Note that this procedure involves two layers of numerical
integration—first to approximate the PDF and second to obtain the CDF—so
small numerical errors can accumulate, and results should be interpreted
with this in mind. The default interval is set to 0.01, which was chosen
as a compromise between numerical accuracy and computational efficiency:
it is sufficiently fine to ensure smooth numerical integration of the
PDF, while remaining coarse enough to avoid unnecessary computational
overhead.</p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="smallest-k">Smallest statistically acceptable K Model (Smallest K)<a class="anchor" aria-label="anchor" href="#smallest-k"></a>
</h2>
<div class="section level3">
<h3 id="erlang-smallest-k">Erlang Smallest K<a class="anchor" aria-label="anchor" href="#erlang-smallest-k"></a>
</h3>
<p>When the <code>SmallestK</code> option is passed as an input, the
algorithm performs a search over decreasing integer values of K to
identify the smallest K that still yields an adequate model fit.
Starting from the best fit K*, the procedure repeatedly lowers K (with λ
updated to preserve the MLE relationship) and re-evaluates the
goodness-of-fit. This continues until the goodness-of-fit no longer
passes at the significance level α (i.e., p* &lt; α), at which point the
last accepted K is recorded as the smallest admissible K. The
corresponding λ, p-value, binary decision q, and log-likelihood are then
reported under the results.</p>
</div>
<div class="section level3">
<h3 id="erlang-exp-smallest-k">Erlang-Exp Smallest K<a class="anchor" aria-label="anchor" href="#erlang-exp-smallest-k"></a>
</h3>
<p>This works the same way as above when the <code>SmallestK</code>
option is passed as an input but internally, it requires a starting
value of K. If an additional input <code>SmallestKValue</code> is
provided, this is used directly and sets the starting value of K for the
iterative search. This can help reduce computational time if users
suspect that the smallest acceptable K is much lower than the
best-fitting K. Otherwise the algorithm runs the Erlang-Fit function to
identify the smallest admissible K and uses this as the starting value
for the Erlang–Exponential model.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vivek Murali, Alison Hill, Anjalika Nande.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
